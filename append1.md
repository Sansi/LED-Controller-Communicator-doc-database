# 附录：表TaskTodo的任务类型及参数

参数之间用英文的逗号 `,` 隔开；项与项之间用 `\n` 分开。

|Id|Command|Parameters|备注	|
| ---: | :--- | :--- | :--- |
|0|密钥更新|||
|1|重启控制器|控制器地址（8字节MAC）||
|2|控制器时间同步|控制器地址|如果控制器地址（8字节MAC）为广播地址的话则所有控制器都要时间同步|
|3|设置控制器调光模式|控制器地址,模式|模式=0远程调光，调光指令由中央控制器发送；模式=1自动调光，集中控制器根据预先设置的时控计划进入时控模式|
|4|设置控制器时控调光计划|控制器地址,终端地址（8字节MAC）,开始月,开始日,结束月,结束日,时,分,秒,调光模式,调光值`\n`|调光模式=0表示后面是直接亮度值，=1表示后面是场景值|
|5|清空控制器时控调光计划|控制器地址||
|6|设置控制器自动调光计划|||
|7|清空控制器自动调光计划|控制器地址||
|8|下载手机号码到控制器|||
|9|查询控制器手机号|控制器地址||
|10|删除控制器中所有手机号|控制器地址||
|11|查询控制器内短信数量|控制器地址||
|12|查询控制器某条短信内容|||
|13|删除控制器某条短信内容|||
|14|查询控制器状态|控制器地址|上海：命令 `0x0080`；LC300：是多条命令的组合。|
|15|查询控制器时控调光计划|控制器地址||
|16|查询控制器自动调光计划|控制器地址||
|17|查询控制器日志|控制器地址||
|18|升级控制器固件|控制器地址,FirmwareMD5|控制器进入固件升级模式，固件升级，退出固件升级模式|
|19|设置控制器所有属性|||
|20|初始化终端信息|控制器地址||
|21|查询终端初始化信息||上海没有|
|22|删除终端信息|控制器地址|删除控制器下所有的终端|
|23|终端调光|控制器地址,终端地址,亮度值`\n`|这个可能主要用于单灯调光。控制器地址（8字节MAC）为广播地址的话是向所有控制器发；终端地址（8字节MAC）是广播地址的话是向控制器下的所有终端发、终端地址（8字节MAC）是组地址的话是向控制器下这个组的终端发、终端地址（8字节MAC）也可以是单个终端的地址|
|24|初始化终端亮度|终端地址,调光渐变时间,上电亮度值,最大亮度值,最小亮度值,故障亮度值,调光系数|25-30的批处理|
|25|设置终端调光渐变时间|终端地址,调光渐变时间||
|26|设置终端上电亮度值|终端地址,上电亮度值||
|27|设置终端最大亮度值|终端地址,最大亮度值||
|28|设置终端最小亮度值|终端地址,最小亮度值||
|29|设置终端故障亮度值|终端地址,故障亮度值||
|30|设置终端调光系数|终端地址,调光系数||
|31|终端恢复出厂设置|终端地址||
|32|终端组设置|终端地址,组号`\n`|LC300:组0不用，就用组1-63|
|33|终端组删除|终端地址|删除终端下的所有组|
|34|终端场景设置|终端地址,场景号,亮度值`\n`||
|35|终端场景删除|终端地址|删除终端下的所有场景|
|36|设置终端自动调光计划|||
|37|删除终端自动调光计划|终端地址||
|38|设置终端信息上报条件|||
|39|设置终端报警阈值条件|||
|40|查询终端状态量终端地址|终端地址`\n`||
|41|查询终端自动调光计划|终端地址||
|42|查询终端组号|终端地址||
|43|查询终端场景|终端地址||
|44|升级终端固件|终端地址,FirmwareMD5|StarRiver服务按流程走|
|45|清零终端总工作时间|终端地址||
|46|清零终端总用电量|终端地址||
|47|设置终端过温保护参数|||
|48|开启关闭终端过温保护||LCP-SH-D没有|
|49|重启StarRiver Server||任务返回值只有0，重启失败时从原理上就无法再将这个任务加到TaskDone了，超时还未从TaskDone读到重启结果可以认为是失败。|
|58|终端调光|控制器地址,终端地址,调光模式,值|调光模式（值）：1-手动（亮度） 2-自动（自动表ID） 3-时控（时控表ID）|
|59|设置紧急调光模式|模式|0：默认亮度，1：最近亮度，2：预存时控计划。通信时复用 `0x000D` 指令，用 `0xA0`, `0xA1` 和 `0xA2` 表示上述模式。|

以下任务类型不由StarRiver提交，尽在StarRiver Server中用于数据帧的识别。

|Id|Command|备注   |
| ---: | :--- | :--- |
|50|DownloadControllerFirmwareBin||
|51|ExitControllerFirmwareUpdateMode||
|52|DownloadDeviceFirmwareMetadata||
|53|DownloadDeviceFirmwareBin||
|54|DownloadFirmwareToDevice||
|55|ExitDeviceFirmwareUpdateMode||
|56|KeepAlive||
|57|Register||
